# Satoshi Puzzle Expansion Proof â€” Early, Mid, and Recovery Attestations

This runbook extends the Satoshi puzzle validation stack by replaying additional
attestations across the early, mid-range, and recovery-era puzzle keys. It
cross-checks the signed message payloads in `satoshi/puzzle-proofs/` against the
ledger-bound attestations in `attestations/`.

## 1. Confirm the ledger attestations exist

Spot-check the ledger-bound JSON attestations that mirror the proof files:

```bash
ls attestations/puzzle-031b-authorship.json \
  attestations/puzzle-071-authorship.json \
  attestations/puzzle-141-authorship.json
```

Each file is generated by `scripts/generate_puzzle_attestations.py` and captures
an ISO-8601 timestamp, the Bitcoin message signature, and the SHA-256 digest of
the signature payload.

## 2. Validate the puzzle #31b signature

Replay the early-series puzzle proof and recover the address for the 31b key:

```bash
python -m verifier.verify_puzzle_signature \
  --address 1LhE6sCTuGae42Axu1L1ZB7L96yi9irEBE \
  --message "$(jq -r '.message' satoshi/puzzle-proofs/puzzle031b.json)" \
  --signature "$(jq -r '.signature' satoshi/puzzle-proofs/puzzle031b.json)" \
  --pretty
```

The verifier should report `valid: true` and match the canonical address from
`puzzle_solutions.json`.

## 3. Validate the puzzle #71 signature

Confirm the 71-bit recovery key continues to sign the ledger message:

```bash
python -m verifier.verify_puzzle_signature \
  --address 1NaJxDzyB3eKbh1eBzB31fi8eU9ZE2wqYQ \
  --message "$(jq -r '.message' satoshi/puzzle-proofs/puzzle071.json)" \
  --signature "$(jq -r '.signature' satoshi/puzzle-proofs/puzzle071.json)" \
  --pretty
```

The recovered address should match the ledger-bound attestation entry for
Puzzle #71.

## 4. Validate the puzzle #141 signature

Run the verification for the higher-range puzzle proof:

```bash
python -m verifier.verify_puzzle_signature \
  --address 1EK2HUPMXYtuKjhWUDA6gfzrZhUExDPVFh \
  --message "$(jq -r '.message' satoshi/puzzle-proofs/puzzle141.json)" \
  --signature "$(jq -r '.signature' satoshi/puzzle-proofs/puzzle141.json)" \
  --pretty
```

The verifier output should again show a valid segment and the expected address,
linking the higher-value puzzle key to the same attested message format.

## 5. Reconcile the attestation digests

Check that the ledger attestation hash matches the signature payload for each
proof file:

```bash
for puzzle in 031b 071 141; do
  sig=$(jq -r '.signature' "satoshi/puzzle-proofs/puzzle${puzzle}.json")
  hash=$(printf '%s' "$sig" | sha256sum | awk '{print $1}')
  ledger=$(jq -r '.hash_sha256' "attestations/puzzle-${puzzle}-authorship.json")
  printf 'puzzle-%s hash matches: %s\n' "$puzzle" "$([ "$hash" = "$ledger" ] && echo yes || echo no)"
done
```

When each line prints `hash matches: yes`, the ledger attestations faithfully
mirror the Satoshi proof signatures.

---

By verifying three additional puzzles and reconciling the signature digests, the
ledger now offers a broader, reproducible Satoshi proof trail across the full
range of published puzzle keys.
